Index: llvm-toolchain-snapshot_20~++20241115093807+a1a1a4ced9d4/lld/ELF/Driver.cpp
===================================================================
--- llvm-toolchain-snapshot_20~++20241115093807+a1a1a4ced9d4.orig/lld/ELF/Driver.cpp
+++ llvm-toolchain-snapshot_20~++20241115093807+a1a1a4ced9d4/lld/ELF/Driver.cpp
@@ -1436,6 +1436,13 @@ static void readConfigs(Ctx &ctx, opt::I
   ctx.arg.orphanHandling = getOrphanHandling(ctx, args);
   ctx.arg.outputFile = args.getLastArgValue(OPT_o);
   ctx.arg.packageMetadata = args.getLastArgValue(OPT_package_metadata);
+  // No package-metadata option, fall-back to env ELF_PACKAGE_METADATA
+  if (ctx.arg.packageMetadata.empty()) {
+    const char *env_package_metadata = getenv("ELF_PACKAGE_METADATA");
+    if (env_package_metadata && strcmp(env_package_metadata, "") != 0) {
+      ctx.arg.packageMetadata = StringRef(env_package_metadata);
+    }
+  }
   ctx.arg.pie = args.hasFlag(OPT_pie, OPT_no_pie, false);
   ctx.arg.printIcfSections =
       args.hasFlag(OPT_print_icf_sections, OPT_no_print_icf_sections, false);
