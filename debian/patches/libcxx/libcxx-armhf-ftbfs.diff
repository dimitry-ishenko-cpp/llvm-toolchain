Index: llvm-toolchain-snapshot_17~++20230217125913+76c638d1ddec/libcxx/include/__atomic/aliases.h
===================================================================
--- llvm-toolchain-snapshot_17~++20230217125913+76c638d1ddec.orig/libcxx/include/__atomic/aliases.h
+++ llvm-toolchain-snapshot_17~++20230217125913+76c638d1ddec/libcxx/include/__atomic/aliases.h
@@ -106,9 +106,13 @@ typedef __conditional_t<_LIBCPP_CONTENTI
 #endif
 
 #if !defined(_LIBCPP_NO_LOCK_FREE_TYPES)
+#ifndef NO_LOCK_FREE
 typedef atomic<__libcpp_signed_lock_free> atomic_signed_lock_free;
 typedef atomic<__libcpp_unsigned_lock_free> atomic_unsigned_lock_free;
 #endif
+#endif
+
+#undef NO_LOCK_FREE
 
 _LIBCPP_END_NAMESPACE_STD
 
